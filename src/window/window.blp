using Gtk 4.0;
using Adw 1;

template $BmiWindow: Adw.ApplicationWindow {
  // Basic window properties
  title: "BMI";
  height-request: 240;
  // Breakpoints
  Adw.Breakpoint simple_breakpoint {
    condition ("min-width: 580sp and max-height: 350sp")
  }
  Adw.Breakpoint advanced_breakpoint {
    condition ("min-width: 840sp and max-height: 730sp")
  }
  // Content
  [content]
  Adw.ToolbarView {
    // Header
    [top]
    Adw.HeaderBar {
      [end]
      MenuButton {
        icon-name: "open-menu-symbolic";
        menu-model: primary_menu;
        primary: true;
      }
    }
    // Content
    content: Adw.ToastOverlay toast_overlay {
      ScrolledWindow {
        hscrollbar-policy: never;
        Adw.Clamp clamp {
          maximum-size: 1100;
          Box orientable_box {
            orientation: vertical;
            margin-start: 20;
            margin-end: 20;
            margin-bottom: 20;

            // Basic inputs
            Adw.Clamp basic_inputs_clamp {
              maximum-size: 400;
              Adw.PreferencesGroup {
                title: _("Inputs");
                $DistanceRow height_input_row {
                  title: _("Height");
                  tooltip-text: _("Affects BMI and BRI");
                  key: "height";
                  lower: 10;
                  upper: 999;
                }
                $MassRow weight_input_row {
                  title: _("Weight");
                  tooltip-text: _("Affects BMI");
                  key: "mass";
                  lower: 10;
                  upper: 999;
                }
              }
            }

            // Advanced inputs
            Adw.Clamp advanced_inputs_clamp {
              maximum-size: 400;
              Adw.PreferencesGroup {
                title: _("Advanced inputs");
                $DropDownRow gender_input_row {
                  title: _("Gender");
                  subtitle: _("Biological gender");
                  tooltip-text: _("Affects healthy/unhealthy thresholds for Waist to Hip ratio");
                  key: "gender";
                  model: StringList {
                    strings [_("Average"), _("Female"), _("Male")]
                  };
                }
                $SpinRow age_input_row {
                  title: _("Age");
                  subtitle: _("Years");
                  tooltip-text: _("Affects healthy/unhealthy thresholds for Waist to Height ratio");
                  key: "age";
                  digits: 0;
                  lower: 18;
                  upper: 150;
                }
                $DistanceRow waist_input_row {
                  title: _("Waist");
                  tooltip-text: _("Affects Waist to Height ratio, Waist to Hip ratio and BRI");
                  key: "waist";
                  lower: 10;
                  upper: 999;
                }
                $DistanceRow hip_input_row {
                  title: _("Hip");
                  tooltip-text: _("Affects Waist to Hip ratio");
                  key: "hip";
                  lower: 10;
                  upper: 999;
                }
              }
            }

            // Results
            Adw.Clamp results_clamp {
              maximum-size: 400;
              Adw.PreferencesGroup {
                title: _("Results");
                $ResultRow bmi_result_row {
                  title: _("BMI");
                  tooltip-text: _("Body Mass Index");
                  digits: 1;
                }
                $ResultRow whtr_result_row {
                  title: _("Waist / Height");
                  tooltip-text: _("Waist to height ratio");
                  digits: 2;
                }
                $ResultRow whr_result_row {
                  title: _("Waist / Hip");
                  tooltip-text: _("Waist to hip ratio");
                  digits: 2;
                }
                $ResultRow bri_result_row {
                  title: _("BRI");
                  tooltip-text: _("Body Roundness Index");
                  digits: 2;
                }
              }
            }

          }
        }
      }
    };
  }
}

menu primary_menu {
  item {
    label: _("Preferences");
    action: "app.preferences";
  }
  item {
    label: _("About BMI");
    action: "app.about";
  }
}